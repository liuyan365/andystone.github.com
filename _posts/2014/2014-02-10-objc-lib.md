---
layout: post
title: objc公用库设计的职业素养 
categories:
- Programming
tags:
- git
---

objc公用库的使用场景还是比较常见的，iOS SDK本身就是公用库的集合；一些开放平台为了方便开发者活着isv开发第三方的app提供相应平台的sdk；还有就是一个比较大的公司一般会有多个甚至几十个app，各个app之间势必会有重复的逻辑，或为了 “提升效率”“安全性” 或者业务指标，会推一些公用的库供各个app使用。公用库是提供给别人使用的，要处处为使用者着想，公用库暴漏的接口以及接入使用的繁简体现了公用库提供方的职业道德和素养，下面是一些常见的问题及解决方案：

* 头文件和接口   
   一个公用库一般会包含如下一些内容：库的二进制文件，头文件以及资源文件。关于头文件只暴漏那些必须的，在实现库的时候能够在实现文件中进行引入的的则在实现文件中进行引入，如果在需要暴漏的头文件中引入另一个头文件，那么这另一个头文件也必须要暴漏出来。   
另一个常见的问题便是接口的方法声明不遵循objc的语言规范，给人以山寨的感觉。还是建议公用库的实现最好有一个当前语言的老手带着做，熟悉当前语言的规范和常用的范式，比如何时使用delegate，何时使用block。   
     
* 编译与集成   
首先应该理清公用库自身的依赖关系，尽可能少地引入第三方的依赖，如果确实需要引入第三方的依赖，那么编译的时候别把第三方库打包进去，如果你很变态，想把三方库也打进去，那么你至少得修改这些三方库的相关的类的类名，静态变量名，如果是category，还得修改其方法名。   
集成一般分两大类：源码集成和二进制库的集成。为了便于源码集成，得讲库自身的源码都放到某个目录以及其子目录下面，这个目录或者子目录中不包含二方或者三方的内容，只是库自身的逻辑代码。源码集成低级一点儿的便是源码拷贝或者git的submodule，高级一点儿的则使用cocoapods进行集成。至于使用二进制库的方式集成，可以分为两种情况，第一是使用官方推荐的静态库的方式，另一种便是通过framework框架的方式进行集成（需要额外安装XCode的插件）。

* 良好的注释和文档   
  所有的方法 如果有特殊的需要注意的，则需要增加注释
  库还得提供一个README文件，用于描述当前库的目的，以及各个接口的使用范例。
  
  
  和库相关的几个命令的使用
  nm
  lipo
  otool
  
  在一个大的公司里面，你想去推动各个团队进行规范化并不是一个简单的事情。